name: Main Workflow

on:
  push:
    branches:
      - main

jobs:
  restore:
    uses: kirandevops1993/NUGET-REUSABLE-/.github/workflows/nuget-reusable.yml@main
    with:
      command: restore
      projects: '**/*.csproj'
      nugetConfigPath: 'NuGet.config'
      arguments: ''
      packagesToPack: ''
      configuration: 'Release'
      custom: true
      restoreArguments: '--interactive'
      testRunTitle: ''
      modifyOutputPath: true
      packDirectory: './custom_pack'
      nobuild: true
      includesymbols: true
      includesource: true
      requestTimeout: '180'
      noCache: true
      restoreDirectory: './restoredir'
      verbosityRestore: 'minimal'
      sensitiveAlphanumericInfo1: 'true'
      versioningScheme: '1.0.0'
      versionEnvVar: 'BUILD_VERSION'
      majorVersion: '1'
      minorVersion: '0'
      patchVersion: '3'
      buildProperties: 'CommitId=abc123'
      verbosityPack: 'detailed'
      workingDirectory: './src'

  build:
    uses: kirandevops1993/NUGET-REUSABLE-/.github/workflows/nuget-reusable.yml@main
    needs: restore
    with:
      command: build
      projects: '**/*.csproj'
      nugetConfigPath: 'NuGet.config'
      arguments: '--configuration Release'
      packagesToPack: ''
      configuration: 'Release'
      custom: true
      restoreArguments: '--interactive'
      testRunTitle: ''
      modifyOutputPath: true
      packDirectory: './custom_pack'
      nobuild: true
      includesymbols: true
      includesource: true
      requestTimeout: '180'
      noCache: true
      restoreDirectory: './restoredir'
      verbosityRestore: 'minimal'
      sensitiveAlphanumericInfo1: 'true'
      versioningScheme: '1.0.0'
      versionEnvVar: 'BUILD_VERSION'
      majorVersion: '1'
      minorVersion: '0'
      patchVersion: '3'
      buildProperties: 'CommitId=abc123'
      verbosityPack: 'detailed'
      workingDirectory: './src'

  test:
    uses: kirandevops1993/NUGET-REUSABLE-/.github/workflows/nuget-reusable.yml@main
    needs: build
    with:
      command: test
      projects: '**/*.csproj'
      nugetConfigPath: 'NuGet.config'
      arguments: '--collect "Code coverage"'
      packagesToPack: ''
      configuration: 'Release'
      custom: true
      restoreArguments: '--interactive'
      testRunTitle: 'CI Test Run'
      modifyOutputPath: true
      packDirectory: './custom_pack'
      nobuild: true
      includesymbols: true
      includesource: true
      requestTimeout: '180'
      noCache: true
      restoreDirectory: './restoredir'
      verbosityRestore: 'minimal'
      sensitiveAlphanumericInfo1: 'true'
      versioningScheme: '1.0.0'
      versionEnvVar: 'BUILD_VERSION'
      majorVersion: '1'
      minorVersion: '0'
      patchVersion: '3'
      buildProperties: 'CommitId=abc123'
      verbosityPack: 'detailed'
      workingDirectory: './src'
